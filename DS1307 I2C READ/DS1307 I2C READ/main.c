#define F_CPU 16000000UL
#define __PROG_TYPES_COMPAT__	//비트맵, 폰트데이터를 sram이 아닌 플래시 메모리에 저장하기 위해 사용

#include <avr/io.h>
#include <util/delay.h>
#include <avr/pgmspace.h>	//비트맵, 폰트데이터를 sram이 아닌 플래시 메모리에 저장하기 위해 사용
#include <avr/interrupt.h>

volatile unsigned int sec_1, sec_10, min_1, min_10, hour_1, hour_10;
unsigned int time_data[3];

const prog_uchar font_42x16[][84] = {
	{0x00, 0x00, 0xC0, 0xC0, 0xE0, 0x70, 0x30, 0x18, 0x18, 0x08, 0x08, 0x0C, 0x0C, 0x0C, 0x0C, 0x06,
	0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x0C, 0x0C, 0x0C, 0x0C, 0x08,
	0x08, 0x18, 0x18, 0x30, 0x70, 0xE0, 0xE0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x07, 0x0E,
	0x0C, 0x18, 0x18, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x60, 0x30, 0x30, 0x30, 0x30, 0x10, 0x10, 0x18, 0x18, 0x0C, 0x0E, 0x07,
	0x07, 0x03, 0x00, 0x00},

	{0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
	0x01, 0x0F, 0x0F, 0x0F, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x00, 0x00},

	{0x00, 0x00, 0xC0, 0xE0, 0xF0, 0x30, 0x18, 0x08, 0x08, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08,
	0x08, 0x18, 0x38, 0x30, 0x70, 0xE0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x0F, 0x0C,
	0x18, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x01, 0x01, 0x07, 0x06, 0x0C, 0x0C, 0x18, 0x18, 0x10, 0x30, 0x30, 0x20, 0x20, 0x60, 0x20, 0x3F,
	0x3F, 0x7F, 0x00, 0x00},

	{0x00, 0x00, 0xC0, 0xE0, 0xF0, 0x30, 0x18, 0x08, 0x08, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08, 0x08,
	0x18, 0x30, 0xF0, 0xF0, 0xF0, 0x38, 0x08, 0x0C, 0x0C, 0x04, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06,
	0x0C, 0x0C, 0x18, 0x18, 0x38, 0xF0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x0F, 0x0C,
	0x18, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x20, 0x20, 0x20, 0x60, 0x30, 0x30, 0x18, 0x18, 0x1C, 0x0F,
	0x03, 0x03, 0x00, 0x00},

	{0x00, 0x00, 0x10, 0x30, 0x30, 0x30, 0x70, 0x70, 0x90, 0x90, 0x90, 0x90, 0x10, 0x10, 0x10, 0x10,
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0xFE, 0xFE, 0xFE, 0x10,
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 0x00, 0x04, 0x0C, 0x04, 0x08, 0x18,
	0x10, 0x10, 0x10, 0x20, 0x60, 0x60, 0x7F, 0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF8, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0,
	0xF0, 0x30, 0x18, 0x18, 0x0C, 0x0C, 0x0C, 0x04, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x0C,
	0x0C, 0x0C, 0x08, 0x18, 0x30, 0xF0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x1F, 0x1F, 0x18,
	0x18, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x13, 0x1F, 0x3C, 0x38, 0x38, 0x30, 0x30,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x20, 0x70, 0x30, 0x30, 0x1C, 0x0F,
	0x07, 0x07, 0x00, 0x00},

	{0x00, 0x00, 0xE0, 0xF0, 0xF8, 0x38, 0x08, 0x0C, 0x0C, 0x0C, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xC0, 0xF0, 0x38, 0x18, 0x18, 0x0C, 0x0C, 0x0C, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x0E,
	0x0C, 0x0C, 0x18, 0x18, 0x30, 0xF0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x07, 0x0E,
	0x0C, 0x08, 0x18, 0x18, 0x10, 0x10, 0x30, 0x30, 0x30, 0x20, 0x23, 0x67, 0x24, 0x38, 0x38, 0x30,
	0x30, 0x30, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x30, 0x30, 0x10, 0x18, 0x18, 0x0C, 0x0F,
	0x03, 0x03, 0x00, 0x00},

	{0x00, 0x00, 0xFE, 0xFE, 0xFE, 0x0C, 0x08, 0x08, 0x10, 0x30, 0x10, 0x30, 0x60, 0x60, 0x40, 0x40,
	0x40, 0xC0, 0xC0, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0x3F, 0x7F, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01,
	0x01, 0x03, 0x03, 0x03, 0x02, 0x02, 0x02, 0x02, 0x06, 0x06, 0x06, 0x06, 0x0C, 0x04, 0x04, 0x04,
	0x04, 0x0C, 0x00, 0x00},

	{0x00, 0x00, 0xC0, 0xC0, 0xF0, 0x30, 0x18, 0x08, 0x08, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08, 0x08,
	0x18, 0x30, 0xE0, 0xE0, 0xF0, 0x38, 0x18, 0x0C, 0x0C, 0x04, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06,
	0x0C, 0x0C, 0x08, 0x18, 0x30, 0xF0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x0F, 0x0C,
	0x18, 0x18, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x10, 0x10, 0x18, 0x0C, 0x0F, 0x07, 0x0F, 0x1C,
	0x10, 0x30, 0x20, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x20, 0x60, 0x30, 0x10, 0x1C, 0x0F,
	0x0B, 0x03, 0x00, 0x00},

	{0x00, 0x00, 0x40, 0xC0, 0xF0, 0x30, 0x18, 0x18, 0x08, 0x0C, 0x0C, 0x04, 0x04, 0x06, 0x06, 0x06,
	0x06, 0x06, 0x0E, 0x0E, 0x0E, 0x1E, 0x3E, 0x36, 0xE6, 0xC6, 0x04, 0x04, 0x0C, 0x0C, 0x0C, 0x0C,
	0x08, 0x18, 0x18, 0x38, 0x70, 0xE0, 0xE0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x02, 0x03, 0x0F, 0x0C,
	0x18, 0x18, 0x30, 0x30, 0x30, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x30, 0x30, 0x38,
	0x1C, 0x1C, 0x0F, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x30, 0x10, 0x10, 0x1C, 0x0F,
	0x0F, 0x07, 0x00, 0x00}
};

const prog_uchar segment_font_42x16[][84] = {
	{0x00, 0x00, 0xF8, 0xF8, 0xF8, 0xF2, 0x06, 0x06, 0x06, 0x0E, 0x0E, 0x0E, 0x0E, 0x0C, 0x0C, 0x0C,
	0x0C, 0x0C, 0x0C, 0x04, 0x00, 0x00, 0x04, 0x0C, 0x0C, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
	0x18, 0x18, 0x08, 0x08, 0xE8, 0xE0, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x07, 0x03,
	0x10, 0x10, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00,
	0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x70, 0x20, 0x40, 0x0F, 0x1F,
	0x1F, 0x1F, 0x00, 0x00},

	{0x00, 0x00, 0x00, 0x00, 0x02, 0x02, 0x06, 0x06, 0x06, 0x06, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0C,
	0x0C, 0x0C, 0x0C, 0x04, 0x00, 0x00, 0x04, 0x0C, 0x0C, 0x0C, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
	0x08, 0x18, 0x18, 0x18, 0x18, 0x08, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF8, 0xF8, 0xF2, 0x02, 0x06, 0x04, 0x0C, 0x0C, 0x0E, 0x0E, 0x0C, 0x0C, 0x0C,
	0x0C, 0x0C, 0x04, 0xE4, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xC0, 0xE0, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x07, 0x07, 0x0F, 0x07,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x0F,
	0x00, 0x20, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x20, 0x20, 0x40, 0x0F, 0x1F,
	0x1F, 0x1F, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF0, 0xF0, 0xE4, 0x04, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08, 0x08, 0x08,
	0x08, 0x08, 0x08, 0xE0, 0xE0, 0xE0, 0x00, 0x08, 0x08, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x38, 0x38, 0x10, 0x10, 0x80, 0x80, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x0F, 0x0F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x1F, 0x0F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x3F,
	0x3F, 0x3F, 0x00, 0x00},

	{0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x18, 0x18,
	0x18, 0x08, 0x00, 0xC0, 0xF0, 0xC0, 0x00, 0x08, 0x18, 0x38, 0x18, 0x18, 0x18, 0x18, 0x10, 0x10,
	0x10, 0x10, 0x10, 0x30, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x20, 0x60, 0x0F, 0x0F, 0x1F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF8, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0xE0, 0xE0, 0xC0, 0x08, 0x08, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x38, 0x38, 0x30, 0x10, 0x80, 0xC0, 0xE0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x0F, 0x07,
	0x00, 0x10, 0x10, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x20, 0x07, 0x0F, 0x0F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x3F,
	0x3F, 0x3F, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF8, 0xF8, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0xF0, 0xF0, 0xE0, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
	0x18, 0x18, 0x08, 0x08, 0xC8, 0xE0, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x07, 0x03,
	0x10, 0x10, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x10, 0x10, 0x10, 0x10, 0x00, 0x07, 0x0F, 0x0F,
	0x00, 0x20, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x20, 0x00, 0x0F, 0x0F,
	0x1F, 0x1F, 0x00, 0x00},

	{0x00, 0x00, 0xE0, 0xC0, 0xC0, 0x90, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
	0x30, 0x30, 0x30, 0x20, 0x00, 0x00, 0x20, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
	0x60, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0x7F, 0x3F, 0x1F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF8, 0xF2, 0xF2, 0x06, 0x06, 0x06, 0x0E, 0x0E, 0x0E, 0x0E, 0x0C, 0x0C, 0x0C,
	0x0C, 0x04, 0x04, 0xF0, 0xF0, 0xE0, 0x04, 0x0C, 0x0C, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
	0x18, 0x18, 0x18, 0x08, 0xC8, 0xE0, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x07, 0x03,
	0x10, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x10, 0x10, 0x10, 0x00, 0x00, 0x0F, 0x0F, 0x07,
	0x00, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x70, 0x20, 0x60, 0x0F, 0x0F,
	0x1F, 0x1F, 0x00, 0x00},

	{0x00, 0x00, 0xF8, 0xF0, 0xF0, 0xE4, 0x04, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08, 0x08, 0x08,
	0x08, 0x08, 0x00, 0xE0, 0xF0, 0xE0, 0x00, 0x08, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x38, 0x38, 0x10, 0x10, 0x80, 0xC0, 0xE0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0x0F, 0x0F,
	0x00, 0x00, 0x10, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x20, 0x07, 0x0F, 0x0F,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x3F,
	0x3F, 0x3F, 0x00, 0x00}
};

//28x32 폰트 배열
const prog_uchar font_28x32[][112] = {
	//0
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xE0, 0xF0, 0x70, 0x38, 0x18, 0x18, 0x18, 0x18,
	0x38, 0x70, 0xF0, 0xE0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0xF0, 0xFF, 0xFF, 0x0F, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x0F,
	0xFF, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0xFF, 0xFF,
	0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0x1F, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x0F, 0x1F, 0x1C, 0x38,
	0x20, 0x30, 0x30, 0x20, 0x38, 0x1C, 0x1F, 0x0F, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	//1
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xF8, 0xF8,
	0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x3F, 0x3F, 0x3F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	//2
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xE0, 0xF0, 0x70, 0x38, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x38, 0x70, 0xF0, 0xE0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x0F, 0x0F, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xE0,
	0xFF, 0x7F, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0,
	0xE0, 0xF0, 0x70, 0x38, 0x1C, 0x0C, 0x06, 0x06, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x3F, 0x3F, 0x23, 0x30, 0x30, 0x30,
	0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00},
	//3
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xE0, 0xF0, 0x18, 0x38, 0x08, 0x08, 0x08, 0x08,
	0x38, 0x18, 0xF0, 0xE0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x07, 0x07, 0x07, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xF0, 0x7F,
	0x3F, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xE0, 0xE0,
	0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x03, 0x07, 0x0F, 0xFE, 0xFC, 0xF8, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x07, 0x0F, 0x1E, 0x1C, 0x30, 0x38,
	0x20, 0x20, 0x20, 0x20, 0x38, 0x30, 0x1C, 0x1E, 0x0F, 0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},
	//4
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xE0,
	0xF0, 0xF8, 0xF8, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xE0, 0xF0, 0x7C, 0x3E, 0x0F, 0x07, 0x03, 0xFF, 0xFF, 0xFF,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xFC,
	0x9F, 0xCF, 0xC3, 0xC1, 0xC0, 0xC0, 0xC0, 0xC0, 0x80, 0xFF, 0xFF, 0xFF, 0x80, 0xC0, 0xC0, 0xC0,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x3F, 0x3F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	//5
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xF8, 0xF8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xF0, 0xFF, 0xFF, 0xE7, 0x70, 0x70, 0x30, 0x30, 0x30, 0x30, 0x70, 0x70, 0xE0, 0xC0,
	0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
	0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xFF, 0xFF, 0xFC, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x0F, 0x1F, 0x1C, 0x30, 0x38, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x38, 0x18, 0x1C, 0x1F, 0x0F, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	//6
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xE0, 0xF0, 0x70, 0x38, 0x38, 0x18, 0x18, 0x18,
	0x38, 0x38, 0xF0, 0xF0, 0xE0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0xF0, 0xFE, 0xFF, 0x8F, 0xC1, 0xC0, 0xE0, 0x60, 0x60, 0x60, 0x60, 0x60, 0xE0, 0xC0, 0xC3,
	0x83, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF,
	0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0xFF, 0xFF, 0xFC, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x0F, 0x1F, 0x1C, 0x30, 0x38,
	0x20, 0x20, 0x20, 0x20, 0x30, 0x30, 0x18, 0x1E, 0x0F, 0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},
	//7
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x98, 0xC8, 0xF8, 0xF8, 0x78, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xF0, 0xFC, 0x7F, 0x1F, 0x07, 0x01,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xC0, 0xF8, 0xFF, 0x7F, 0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3E, 0x3F, 0x3F,
	0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	//8
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xE0, 0xF0, 0x70, 0x38, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x38, 0x70, 0xF0, 0xE0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x1F, 0x3F, 0x7F, 0xF0, 0xE0, 0xC0, 0x80, 0x80, 0x80, 0x80, 0x80, 0xC0, 0xE0, 0xF0,
	0x7F, 0x3F, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0xFC, 0xFE,
	0x0F, 0x07, 0x03, 0x03, 0x01, 0x01, 0x01, 0x01, 0x03, 0x03, 0x07, 0x0F, 0xFF, 0xFE, 0xFC, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x07, 0x0F, 0x1E, 0x1C, 0x30, 0x38,
	0x20, 0x20, 0x20, 0x20, 0x38, 0x30, 0x18, 0x1C, 0x0F, 0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},
	//9
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xE0, 0xF0, 0x70, 0x38, 0x38, 0x18, 0x18, 0x18, 0x18,
	0x38, 0x38, 0x70, 0xF0, 0xE0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x7F, 0xFF, 0xFF, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC1,
	0xDD, 0xFF, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03,
	0x07, 0x07, 0x0E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0E, 0x06, 0x07, 0xE3, 0xFB, 0xFF, 0x1F, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x0F, 0x1F, 0x1C, 0x38, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x38, 0x1C, 0x1E, 0x0F, 0x07, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
};

// 16*32 (:)폰트 배열
const prog_uchar dot_font[][16] = {
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x07, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xC0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
};


void com_write(uint8_t com);
void data_write(uint8_t data);
void draw_font_28x32(int x, int ch);
void draw_font_42_16(int x, int y, int ch,int mode);
void oled_init(void);
void oled_clear(void);
void digit_num(unsigned int *ch);
void draw_dot(int x);
void RTC_init(void);
void RTC_read(void);

//28x32 폰트 출력 함수
void draw_font_28x32(int x, int ch)
{
	unsigned int i, j, k =0;
	unsigned int high, low;

	high = x / 16;
	low = x % 16;

	for(i=0; i<4; i++)
	{
		com_write(0xb0+i);
		com_write(0x00+low);
		com_write(0x10+high);

		for(j=0; j < 28; j++)
		{
			data_write(pgm_read_byte(&font_28x32[ch][k++]));
		}
	}
}


//42x16 폰트 출력 함수
void draw_font_42_16(int x, int y, int ch,int mode)
{
	unsigned int i, j, k =0;
	unsigned int high, low;

	high = x / 16;
	low = x % 16;

	if(mode == 0)
	{
		for(i=0; i<2; i++)
		{
			com_write(0xb0+i+y);
			com_write(0x00+low);
			com_write(0x10+high);
			for(j=0; j < 42; j++)
			{
				data_write(pgm_read_byte(&segment_font_42x16[ch][k++]));
			}
		}
	}

	else
	{
		for(i=0; i<2; i++)
		{
			com_write(0xb0+i+y);
			com_write(0x00+low);
			com_write(0x10+high);

			for(j=0; j < 42; j++)
			{
				data_write(pgm_read_byte(&font_42x16[ch][k++]));
			}
		}
	}

}


void draw_dot(int x)
{
	unsigned int i, j, k =0;
	unsigned int high, low;

	high = x / 16;
	low = x % 16;

	for(i=0; i<4; i++)
	{
		k =0;
		com_write(0xb0+i);
		com_write(0x00+low);
		com_write(0x10+high);

		for(j=0; j < 16; j++)
		{
			data_write(pgm_read_byte(&dot_font[i][k++]));
		}
	}
}


//OLED 화면 클리어 함수
void oled_clear(void)
{
	unsigned int i, j;

	for(i=0; i<4; i++)
	{
		com_write(0xb0+i);
		com_write(0x00);
		com_write(0x10);
		for(j=0; j < 128; j++)
		{
			data_write(0x00);	//0X00으로 전부 채운다.
		}
	}
}


//OLED 화면 초기화 함수
void oled_init(void)
{ com_write(0xAE); //display off
	com_write(0x20); //Set Memory Addressing Mode
	com_write(0x10); //00,Horizontal Addressing Mode;01,Vertical Addressing Mode;10,Page Addressing Mode (RESET);11,Invalid
	com_write(0xb0); //Set Page Start Address for Page Addressing Mode,0-7
	com_write(0xc8); //Set COM Output Scan Direction
	com_write(0x00); //---set low column address
	com_write(0x10); //---set high column address
	com_write(0x40); //--set start line address

	com_write(0x81); //--set contrast control register*
	com_write(0xFF);

	com_write(0xa1); //--set segment re-map 0 to 127
	com_write(0xa6); //--set normal display
	com_write(0xa8); //--set multiplex ratio(1 to 64)
	com_write(0x1F); //
	com_write(0xa4); //0xa4,Output follows RAM content;0xa5,Output ignores RAM content
	com_write(0xd3); //-set display offset
	com_write(0x00); //-not offset
	com_write(0xd5); //--set display clock divide ratio/oscillator frequency
	com_write(0xf0); //--set divide ratio
	com_write(0xd9); //--set pre-charge period

	com_write(0x22); //
	com_write(0xda); //--set com pins hardware configuration
	com_write(0x02);
	com_write(0xdb); //--set vcomh

	com_write(0x20); //0x20,0.77xVcc
	com_write(0x8d); //--set DC-DC enable
	com_write(0x14); //
	com_write(0xaf); //--turn on oled panel
}

//각자리수값 구하는 함수
void digit_num(unsigned int *ch)
{
	sec_1 = ch[0]&0x0F;
	sec_10 = (ch[0]&0xF0) >> 4;
	min_1 = ch[1]&0x0F;
	min_10 = (ch[1]&0xF0) >> 4;
	hour_1 = ch[2]&0x0F;
	hour_10 = (ch[2]&0xF0) >> 4;
}


//SSD1306 커맨드 전송 함수
void com_write(uint8_t com)
{
	TWCR=0xA4;	//Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0x78;	//slave address + R/W
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x00;	//command 모드
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWDR=com;	//data 출력
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWCR=0x94;	//Send STOP
}

//SSD1306 데이터 전송 함수
void data_write(uint8_t data)
{
	TWCR=0xA4;	//Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0x78;	//slave address + R/W
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x40;	//data 모드
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWDR=data;	//data 출력
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWCR=0x94;	//Send STOP
}

void RTC_read(void)
{
	TWCR=0xA4;    //Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0xD0;    //slave address + W
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWDR=0x00;    //
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWCR=0x94;    //Send STOP


	TWCR=0xA4;    //Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0xD1;    //slave address + R
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWCR=0xC4;
	while (!(TWCR & (1<<TWINT)));
	time_data[0]=TWDR;   //sec
	
	TWCR=0xC4;
	while (!(TWCR & (1<<TWINT)));
	time_data[1]=TWDR;   //min
	
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	time_data[2]=TWDR;   //hour

	TWCR=0x94;    //Send STOP
}

void set_time(void)
{
	TWCR=0xA4;	//Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0xD0;	//slave address + R/W
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x00;	//data 모드
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWDR=0x00;	//data 출력
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x00;	//data 출력
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x00;	//data 출력
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));

	TWCR=0x94;	//Send STOP
}

void RTC_init(void)
{
	TWCR=0xA4;    //Send START
	while (!(TWCR & (1<<TWINT)));

	TWDR=0xD0;    //slave address + R/W
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x07;    //control register
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWDR=0x00;    //1Hz로 설정
	TWCR=0x84;
	while (!(TWCR & (1<<TWINT)));
	
	TWCR=0x94;    //Send STOP
}


int main(void)
{
	DDRC = 0xFF;

	TWBR = 72;	//(CPU_Clock/SCL_Clock) - 16)/2 = TWBR*(4^TWPS) -> 통신속도 400kHz설정
	TWSR = 0x00;

	oled_init();	//OLED 초기화
	oled_clear();
	RTC_init();
	set_time();
	_delay_ms(50);

	while(1)
	{
		RTC_read();
		digit_num(time_data);
		/*
		draw_font_28x32(100,digit_1);		//1의 자리 출력
		draw_font_28x32(72,digit_10);		//10의자리 출력
		draw_dot(58);
		draw_font_28x32(28,digit_100);		//100의 자리 출력
		draw_font_28x32(0,digit_1000);		//1000의 자리 출력
		*/

		draw_font_42_16(0,0,hour_1,0);
		draw_font_42_16(0,2,hour_10,0);

		draw_font_42_16(43,0,min_1,0);
		draw_font_42_16(43,2,min_10,0);

		draw_font_42_16(85,0,sec_1,0);
		draw_font_42_16(85,2,sec_10,0);
	}
}